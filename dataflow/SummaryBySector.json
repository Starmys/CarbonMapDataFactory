{
	"name": "SummaryBySector",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "Aviation",
						"type": "DatasetReference"
					},
					"name": "Aviation"
				},
				{
					"dataset": {
						"referenceName": "GroundTransport",
						"type": "DatasetReference"
					},
					"name": "GroundTransport"
				},
				{
					"dataset": {
						"referenceName": "Industry",
						"type": "DatasetReference"
					},
					"name": "Industry"
				},
				{
					"dataset": {
						"referenceName": "Power",
						"type": "DatasetReference"
					},
					"name": "Power"
				},
				{
					"dataset": {
						"referenceName": "Residential",
						"type": "DatasetReference"
					},
					"name": "Residential"
				},
				{
					"dataset": {
						"referenceName": "InternationalShipping",
						"type": "DatasetReference"
					},
					"name": "InternationalShipping"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "AzureSqlTable2",
						"type": "DatasetReference"
					},
					"name": "sink1"
				}
			],
			"transformations": [
				{
					"name": "Sum1"
				},
				{
					"name": "Sum2"
				},
				{
					"name": "Sum3"
				},
				{
					"name": "Sum4"
				},
				{
					"name": "Sum5"
				},
				{
					"name": "Select1"
				},
				{
					"name": "Select2"
				},
				{
					"name": "Select3"
				},
				{
					"name": "Select4"
				},
				{
					"name": "Select5"
				},
				{
					"name": "Join1"
				},
				{
					"name": "Join2"
				},
				{
					"name": "Join3"
				},
				{
					"name": "Join4"
				},
				{
					"name": "Join5"
				},
				{
					"name": "Select6"
				},
				{
					"name": "Sum6"
				}
			],
			"script": "source(output(\n\t\t{_c0} as date 'dd/MM/yyyy',\n\t\tChina as double,\n\t\tIndia as double,\n\t\tUS as double,\n\t\t{EU27&UK} as double,\n\t\tRussia as double,\n\t\tJapan as double,\n\t\tBrazil as double,\n\t\tROW as double,\n\t\tInternationalAviation as double\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false) ~> Aviation\nsource(output(\n\t\t{_c0} as date 'dd/MM/yyyy',\n\t\tChina as double,\n\t\tIndia as double,\n\t\tUS as double,\n\t\t{EU27&UK} as double,\n\t\tRussia as double,\n\t\tJapan as double,\n\t\tBrazil as double,\n\t\tROW as double\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false) ~> GroundTransport\nsource(output(\n\t\t{_c0} as date 'dd/MM/yyyy',\n\t\tChina as double,\n\t\tIndia as double,\n\t\tUS as double,\n\t\t{EU27&UK} as double,\n\t\tRussia as double,\n\t\tJapan as double,\n\t\tBrazil as double,\n\t\tROW as double\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false) ~> Industry\nsource(output(\n\t\t{_c0} as date 'dd/MM/yyyy',\n\t\tChina as double,\n\t\tIndia as double,\n\t\tUS as double,\n\t\t{EU27&UK} as double,\n\t\tRussia as double,\n\t\tJapan as double,\n\t\tBrazil as double,\n\t\tROW as double\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false) ~> Power\nsource(output(\n\t\t{_c0} as date 'dd/MM/yyyy',\n\t\tChina as double,\n\t\tIndia as double,\n\t\tUS as double,\n\t\t{EU27&UK} as double,\n\t\tRussia as double,\n\t\tJapan as double,\n\t\tBrazil as double,\n\t\tROW as double\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false) ~> Residential\nsource(output(\n\t\tDate as date 'yyyy-MM-dd',\n\t\tWorld as double\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false) ~> InternationalShipping\nAviation derive(Aviation = round(China+India+US+{EU27&UK}+Russia+Japan+Brazil+ROW+InternationalAviation, 2)) ~> Sum1\nGroundTransport derive(GroundTransport = round(China+India+US+{EU27&UK}+Russia+Japan+Brazil+ROW, 2)) ~> Sum2\nIndustry derive(Industry = round(China+India+US+{EU27&UK}+Russia+Japan+Brazil+ROW,2)) ~> Sum3\nPower derive(Power = round(China+India+US+{EU27&UK}+Russia+Japan+Brazil+ROW,2)) ~> Sum4\nResidential derive(Residential = round(China+India+US+{EU27&UK}+Russia+Japan+Brazil+ROW,2)) ~> Sum5\nSum1 select(mapColumn(\n\t\t{_c0},\n\t\tAviation\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> Select1\nSum2 select(mapColumn(\n\t\t{_c0},\n\t\tGroundTransport\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> Select2\nSum3 select(mapColumn(\n\t\t{_c0},\n\t\tIndustry\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> Select3\nSum4 select(mapColumn(\n\t\t{_c0},\n\t\tPower\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> Select4\nSum5 select(mapColumn(\n\t\t{_c0},\n\t\tResidential\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> Select5\nSelect1, Select2 join(Select1@{_c0} == Select2@{_c0},\n\tjoinType:'inner',\n\tbroadcast: 'auto')~> Join1\nJoin1, Select3 join(Select1@{_c0} == Select3@{_c0},\n\tjoinType:'inner',\n\tbroadcast: 'auto')~> Join2\nJoin2, Select4 join(Select1@{_c0} == Select4@{_c0},\n\tjoinType:'inner',\n\tbroadcast: 'auto')~> Join3\nJoin3, Select5 join(Select1@{_c0} == Select5@{_c0},\n\tjoinType:'inner',\n\tbroadcast: 'auto')~> Join4\nJoin4, InternationalShipping join(Select1@{_c0} == Date,\n\tjoinType:'outer',\n\tbroadcast: 'auto')~> Join5\nJoin5 select(mapColumn(\n\t\tDate = Select1@{_c0},\n\t\tAviation,\n\t\tGroundTransport,\n\t\tIndustry,\n\t\tPower,\n\t\tResidential,\n\t\tInternationalShipping = World\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> Select6\nSelect6 derive(Globe = Aviation+GroundTransport+Industry+Power+Residential+InternationalShipping) ~> Sum6\nSum6 sink(input(\n\t\tDATE as timestamp,\n\t\tPower as double,\n\t\t{Ground Transport} as double,\n\t\tIndustry as double,\n\t\tResidential as double,\n\t\tAviation as double,\n\t\t{International Shipping} as double,\n\t\tGlobe as double\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tdeletable:false,\n\tinsertable:true,\n\tupdateable:false,\n\tupsertable:false,\n\tformat: 'table',\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\terrorHandlingOption: 'stopOnFirstError') ~> sink1"
		}
	}
}